<!DOCTYPE html>
<html lang="cn">
<head>
    <meta charset="UTF-8">
    <title>选择弹窗</title>
    <link rel="stylesheet" href="../src/plugin/jquery.dialog/jquery.dialog.css">
    <link rel="stylesheet" href="../style/common.css">
    <link rel="stylesheet" href="../style/default.css">
    <link rel="stylesheet" href="../style/global.css">
    <link rel="stylesheet" href="../style/select-plugin.css">
</head>
<body>
        <!--<button id="selectPluginButtonContract">选择合约</button>-->

        <button id="selectPluginButtonGoods">选择商品</button>

        <button id="selectPluginButtonUsers">选择用户</button>

        <button id="selectPluginButtonCoupon">选择优惠券</button>

        <button id="selectPluginButtonWarehouse">选择仓库</button>
</body>
<script type="text/javascript" src="../src/plugin/jq.js"></script>
<script type="text/javascript" src="../src/plugin/underscore.js"></script>
<script type="text/javascript" src="../src/plugin/jquery.dialog/jquery.dialog.js"></script>
<script type="text/javascript" src="../src/plugin/jquery.dialog/jquery.drag.js"></script>
<script type="text/javascript" src="../src/plugin/jquery.dialog/jquery.mask.js"></script>
<script type="text/javascript" src="../src/plugin/jquery.paginator/jqPaginator.min.js"></script>
<script type="text/javascript" src="../src/fn/select-plugin.js"></script>
<script>
;(function () {
//    var button = document.getElementById('selectPluginButton');
//    $('#selectPluginButtonContract').selectPlugin({
//        isSku:true,
//        type:10,
//        title:'全部合约',
//        selectSuccess: function(data){
//            console.log(data)
//        }
//    });
//
    $('#selectPluginButtonGoods').selectPlugin({
        isSku:true,
        isSelectAll:false,
        type:0,
        title:'选择商品',
        selectSuccess: function(data){
            console.log(data)
        },
        selectError: function (info) {
            console.error(info);
        }
    });

    $('#selectPluginButtonUsers').selectPlugin({
        single:true,
        isSku:false,
        isSelectAll:false,
        type:1,
        title:'选择用户',
        selectLength: 5,
        selectSuccess: function(data){
            console.log(data)
        },
        selectError: function (info) {
            console.error(info);
        }
    });

    $('#selectPluginButtonCoupon').selectPlugin({
        single:true,
        isSku:false,
        isSelectAll:false,
        type:2,
        title:'选择优惠券',
        selectLength: 5,
        selectSuccess: function(data){
            console.log(data)
        },
        selectError: function (info) {
            console.error(info);
        }
    });

    $('#selectPluginButtonWarehouse').selectPlugin({
        single:false,
        isSku:false,
        isSelectAll:true,
        type:3,
        title:'选择仓库',
        selectLength: 5,
        selectSuccess: function(data){
            console.log(data)
        },
        selectError: function (info) {
            console.error(info);
        }
    })

})();
</script>

<!--------------------------- 选择弹框selectPlugin模板 ---------------------------------->
<!-- 弹窗模板 0 商品, 1 用户, 2 优惠券 , 3 仓库, 10 合约 -->
<script type="text/template" id="j-select-plugin-popup-dialog">
    <div class="ui-box" style="height: 328px;overflow: scroll">
        <div class="ui-box form-inline">
            <!--<div class="form-group">-->
            <!--<select class="form-control form-control-sm j-category-one" name="cate_key" cb-node="cate_key">-->
            <!--<option value="">请选择类目</option>-->
            <!--</select>-->
            <!--</div>-->
            <!--&nbsp;-->
            <!--<div class="form-group" style="display: none">-->
            <!--<select class=" form-control form-control-md" name="category_two" cb-node="category_two">-->
            <!--<option value="">请选择二级类目</option>-->
            <!--</select>-->
            <!--</div>-->
            <!--&nbsp;-->
            <!--<div class="form-group">-->
            <!--<select class="form-control form-control-sm" name="brand_key" cb-node="brand_key">-->
            <!--<option value="">请选择品牌</option>-->
            <!--</select>-->
            <!--</div>-->
            &nbsp;
            <% if( type == 2 ){ %>
            <div class="form-group">
                <select class="form-control" id="j-select-plugin-coupon_lifecycle">
                    <option data-value="0">全部</option>
                    <option data-value="1">未开始</option>
                    <option data-value="2">已开始</option>
                    <option data-value="3">已过期</option>
                </select>
            </div>
            <% } %>
            <% if( type == 3 ){ %>
            <div class="form-group">
                <input type="checkbox" id="warehouse">
                <label class="ui-label ui-label-lg" for="warehouse">只显示开放仓库</label>
            </div>
            <% } %>
            <div class="form-group">
                <div class="input-group">
                    <input type="text" class="form-control form-control-md" id="select-plugin-keyword" placeholder="请输入关键词">
                    <div class="input-group-btn"><a class="btn btn-sm btn-default" id="j-select-plugin-search-<%= type %>">搜索</a></div>
                </div>
            </div>
        </div>
        <table class="ui-table">
            <thead>
            <% if( type == 0 ){ %>
            <tr>
                <th class="tc">图片</th>
                <th>标题<a href="javascript:;" class="j-select-plugin-refresh-<%= type %>">&nbsp;&nbsp;刷新&nbsp;</a></th>
                <th class="tc">创建时间</th>
                <th class="tc">状态</th>
                <th class="tc">类型</th>
                <th class="tc">操作</th>
            </tr>
            <% }else if( type == 1 ){ %>
            <tr>
                <th class="tc">ID</th>
                <th class="tc">用户名</th>
                <th class="tc">账号<a href="javascript:;" class="j-select-plugin-refresh-<%= type %>">&nbsp;&nbsp;刷新&nbsp;</a></th>
                <th class="tc">注册时间</th>
                <th class="tc">操作</th>
            </tr>
            <% }else if( type == 2 ){ %>
            <tr>
                <th class="tc">优惠券名称</th>
                <th class="tc">面值（元）</th>
                <th class="tc">创建时间</th>
                <th class="tc">状态</th>
                <th class="tc">类型</th>
                <th class="tc">操作</th>
            </tr>
            <% }else if( type == 3 ){ %>
            <tr>
                <th class="tc">ID</th>
                <th class="tc">简称</th>
                <th class="tc">全称</th>
                <th class="tc">地址</th>
                <th class="tc">状态</th>
                <th class="tc">操作</th>
            </tr>
            <% }else if( type == 10 ){ %>
            <tr>
                <th class="tc">合约名称</th>
                <th>运营商<a href="javascript:;" class="j-select-plugin-refresh-<%= type %>">&nbsp;&nbsp;刷新&nbsp;</a></th>
                <th class="tc">城市</th>
                <th class="tc">操作</th>
            </tr>
            <% } %>
            </thead>
            <tbody id="j-select-plugin-render">
            <tr>
                <td colspan="18" class="tc">没有任何记录!</td>
            </tr>
            </tbody>
        </table>
    </div>
    <!-- 页码开始 -->
    <div class="ui-box">
        <div class="widget-list">
            <div>
                <a href="javascript:;" class="btn btn-sm btn-success j-select-plugin-gsa-<%= type %>" style="display: none">全选本页</a>
                <a href="javascript:;" class="btn btn-sm btn-success j-select-plugin-save-<%= type %>" style="display: none">确定使用</a>
                <span style="margin-left: 20px;">提示：滚动鼠标查看隐藏部分</span>
            </div>
            <div class="list-page">
                <div class="ui-pagination selectPluginPagination"></div>
            </div>
        </div>
    </div>
    <!-- 页码结束 -->
</script>

<!-- 弹窗 商品列表模板 -->
<!-- 根据type类型进行判断：type=1选择的是sku级别，没有type选择的是商品级别 -->
<script type="text/template" id="j-select-plugin-table-template">
    <% _.each(items,function(item,index){ %>
    <% if( type == 0 ){ %>
    <tr class="j-select-plugin-box">
        <td class="tc"><span><img src="<%= item.icon_url %>" style="width: 50px;height: 50px;"></span></td>
        <td><span class="popup-g-name"><%= item.item_name %></span></td>
        <td class="tc"><span><%= item.gmt_created %></span></td>
        <td class="tc">
            <% if( item.item_status == 4 ){ %>
            <span class="green"><%= item.status_name || '-' %></span>
            <% }else if( item.item_status == 1 ){ %>
            <span class="red"><%= item.status_name || '-' %></span>
            <% }else{ %>
                        <span class="black"><%= item.status_name || '-' %>
                    </span>
            <% } %>
        </td>
        <td class="tc"><%= ['国内','跨境'][item.higo_mark] %></td>
        <% if( isSku && isSku === true ){ %>
        <td class="tc"><a class="j-open-sku" data-id="<%= item.id %>" data-name="<%= item.item_name %>" data-item_image_url="<%= item.icon_url %>" data-sid="<%= item.seller_id %>" style="cursor: pointer">展开并添加</a></td>
        <% }else{ %>
        <td><a class="selectDialogPlugin select-group-goods j-select-plugin-g-<%= type %>" data-status="0" data-id="<%= item.id %>" data-info="<%= encodeURIComponent(JSON.stringify(item)) %>">选择</a></td>
        <% } %>
    </tr>
    <tr class="j-select-plugin-sku-box sku-box-<%= item.id %>" style="display: none;">
        <td colspan="20">
            <table class="ui-table">
                <thead>
                <tr>
                    <th class="tc">图片</th>
                    <th class="tc">sku_id</th>
                    <th class="tc">sku属性</th>
                    <th class="tc">原价</th>
                    <th class="tc">现价</th>
                    <th class="tc">库存</th>
                    <th class="tc">操作</th>
                </tr>
                </thead>
                <tbody class="sku-item-<%= item.id %>">

                </tbody>
            </table>
        </td>
    </tr>
    <% }else if( type == 1 ){ %>
    <tr class="j-select-plugin-box">
        <td class="tc"><span><%= item.id %></span></td>
        <td class="tc"><span><%= item.name %></span></td>
        <td class="tc"><span><%= item.mobile %></span></td>
        <td class="tc"><span><%= item.gmt_created %></span></td>
        <td class="tc"><a class="selectDialogPlugin select-group-goods j-select-plugin-g-<%= type %>" data-status="0" data-id="<%= item.id %>" data-info="<%= encodeURIComponent(JSON.stringify(item)) %>">选择</a></td>
    </tr>
    <% }else if( type == 2 ){ %>
    <tr class="j-select-plugin-box">
        <td class="tc"><span><%= item.name %></span></td>
        <td class="tc"><span><%= (item.discount_amount / 100).toFixed(2) %></span></td>
        <td class="tc"><span><%= item.gmt_created %></span></td>
        <td class="tc"><% if( item.status == 2 ){ %>
            <span>已失效</span>
            <% }else if( item.status == 1 ){ %>
            <% if( item.market_activity.lifecycle == 1 ){ %>
            <span>未开始</span>
            <% }else if( item.market_activity.lifecycle == 2 ){ %>
            <span>已开始</span>
            <% }else if( item.market_activity.lifecycle == 3){ %>
            <span>已结束</span>
            <% } %>
            <% } %></td>
        <td class="tc">
            <% if( item.valid_duration ){ %>
            <span>领取日期</span>
            <% }else{ %>
            <span>固定时间</span>
            <% } %>
        </td>
        <td class="tc"><a class="selectDialogPlugin select-group-goods j-select-plugin-g-<%= type %>" data-status="0" data-id="<%= item.id %>" data-info="<%= encodeURIComponent(JSON.stringify(item)) %>">选择</a></td>
    </tr>
    <% }else if( type == 3 ){ %>
    <tr class="j-select-plugin-box">
        <td class="tc"><%= item.id %></td>
        <td class="tc"><%= item.sname %></td>
        <td class="tc"><%= item.name %></td>
        <td class="tc"><%= item.address %></td>
        <td class="tc"><%= ['关闭','开放'][item.status] %></td>
        <td class="tc"><a class="selectDialogPlugin select-group-goods j-select-plugin-g-<%= type %>" data-status="0" data-id="<%= item.id %>" data-info="<%= encodeURIComponent(JSON.stringify(item)) %>">选择</a></td>
    </tr>
    <% }else if( type == 10 ){ %>
    <tr class="j-select-plugin-box">
        <td class="tc"><span><%= item.user_name %></span></td>
        <td class="tc"><span><%= item.mobile %></span></td>
        <td class="tc"><a class="selectDialogPlugin select-group-goods j-select-plugin-g-<%= type %>" data-status="0" data-id="<%= item.id %>" data-info="<%= encodeURIComponent(JSON.stringify(item)) %>">选择</a></td>
    </tr>
    <% } %>
    <% }) %>
</script>

<!-- 弹窗 展开商品对应的sku -->
<script type="text/template" id="j-select-plugin-sku">
    <% _.each(items,function(item,index){ %>
    <tr>
        <td class="tc"><img src="<%= item.image_url %>"></td>
        <td class="tc"><span><%= item.sku_id %></span></td>
        <td class="tc"><span><%= item.prop[0].prop_name || '-' %></span>:<span><%= item.prop[0].value_name || '-' %></span></td>
        <td class="tc"><span><%= Number(item.origin_price/100).toFixed(2) %></span></td>
        <td class="tc"><span><%= Number(item.price/100).toFixed(2) %></span></td>
        <td class="tc"><span><%= item.num %></span></td>
        <td class="tc"><a href="javascript:;" class="selectDialogPlugin select-group-goods j-select-plugin-g-<%= type %>" data-status="0" data-id="<%= item.sku_id %>" data-info="<%= encodeURIComponent(JSON.stringify(item)) %>">选择</a></td>
    </tr>
    <% }) %>
</script>

</html>